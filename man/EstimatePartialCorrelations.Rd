% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/partial_correlations.R
\name{EstimatePartialCorrelations}
\alias{EstimatePartialCorrelations}
\title{Estimate Partial Correlations via Pseudolikelihood}
\usage{
EstimatePartialCorrelations(
  expressionMatrix,
  metadata = NULL,
  family = "zinb",
  method = "glm",
  minNonZero = 10,
  progressr = TRUE,
  parallel = FALSE,
  numWorkers = NULL,
  verbose = TRUE
)
}
\arguments{
\item{expressionMatrix}{A numeric matrix where rows are features (genes) and columns
are observations (cells). Can be a regular matrix or sparse Matrix.}

\item{metadata}{Optional data frame of metadata variables to include as covariates.
Must have the same number of rows as columns in expressionMatrix.}

\item{family}{Character string specifying the distribution family for pseudolikelihood estimation.
Options: "zinb" (zero-inflated negative binomial, default), "nb" (negative binomial),
"poisson", "gaussian", "quasipoisson".}

\item{method}{Character string specifying the estimation method.
Options: "glm" (generalized linear model, default), "correlation" (Pearson/Spearman).}

\item{minNonZero}{Minimum number of non-zero observations required for a feature
pair to be estimated (default: 10).}

\item{progressr}{Logical indicating whether to use progressr for progress reporting
during parallel computation (default: TRUE).}

\item{parallel}{Logical indicating whether to use parallel processing (default: FALSE).}

\item{numWorkers}{Integer specifying number of workers for parallel processing.
If NULL, uses detectCores()-1 (default: NULL).}

\item{verbose}{Logical indicating whether to print progress messages (default: TRUE).}
}
\value{
A list with components:
  \itemize{
    \item partial_cor: Symmetric matrix of partial correlations between features
    \item se: Standard errors for each partial correlation (if computed)
    \item pvalues: P-values for testing H0: partial correlation = 0 (if computed)
    \item n_pairs: Number of valid feature pairs analyzed
    \item family: The family used for estimation
    \item features: Names of features included in the analysis
  }
}
\description{
Computes partial correlations between features using pseudolikelihood estimation.
This function supports various families including zero-inflated negative binomial
for single-cell data analysis. Partial correlations represent the direct relationship
between features after conditioning on all other features.
}
\details{
For zero-inflated negative binomial (zinb) family, the function uses a two-stage
approach: first fitting the zero-inflation component, then estimating partial
correlations from the count component via pseudolikelihood. The partial correlations
are computed as the negative normalized precision matrix elements.

When parallel=TRUE, the function uses future/future.apply for parallelization
and progressr for progress tracking.
}
\examples{
\dontrun{
# Estimate partial correlations using ZINB pseudolikelihood
result <- EstimatePartialCorrelations(
  expressionMatrix = expr_matrix,
  family = "zinb",
  parallel = TRUE
)

# Access the partial correlation matrix
pcor_matrix <- result$partial_cor

# With metadata covariates
result <- EstimatePartialCorrelations(
  expressionMatrix = expr_matrix,
  metadata = meta_df,
  family = "zinb"
)
}
}
