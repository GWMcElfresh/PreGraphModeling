% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/visualize_rbm.R
\name{PlotPartialCorrelationHeatmap}
\alias{PlotPartialCorrelationHeatmap}
\title{Plot Partial Correlations as Heatmap}
\usage{
PlotPartialCorrelationHeatmap(
  rbmObject,
  features = NULL,
  nEdges = 50,
  nFeatures = NULL,
  cluster_rows = TRUE,
  cluster_columns = TRUE,
  show_row_names = TRUE,
  show_column_names = TRUE,
  color_palette = "RdBu",
  title = "RBM Partial Correlations",
  name = "Partial\\nCorrelation",
  ...
)
}
\arguments{
\item{rbmObject}{An RBM object fitted using FitRBM().}

\item{features}{Optional character vector of specific features to plot.
If NULL, selects features from the strongest partial correlations.}

\item{nEdges}{Integer. If features is NULL, select features from the top nEdges
absolute partial correlations (default: 50).}

\item{nFeatures}{Optional integer. If provided and features is NULL, cap the
number of selected features (vertices) to this value (default: NULL).}

\item{cluster_rows}{Logical indicating whether to cluster rows (default: TRUE).}

\item{cluster_columns}{Logical indicating whether to cluster columns (default: TRUE).}

\item{show_row_names}{Logical indicating whether to show row names (default: TRUE).}

\item{show_column_names}{Logical indicating whether to show column names (default: TRUE).}

\item{color_palette}{Character string specifying color palette.
Options: "RdBu", "viridis", "plasma", "RdYlBu" (default: "RdBu").}

\item{title}{Character string for heatmap title (default: "RBM Partial Correlations").}

\item{name}{Character string for color legend name (default: "Partial\nCorrelation").}

\item{...}{Additional arguments passed to ComplexHeatmap::Heatmap().}
}
\value{
A ComplexHeatmap object that can be drawn or further customized.
}
\description{
Creates a heatmap visualization of the partial correlation matrix from an RBM
using ComplexHeatmap. The heatmap shows the relationships between features
(genes) after conditioning on all other features.
}
\details{
The heatmap displays partial correlations between features, which represent
direct relationships after accounting for all other features. Strong positive
correlations (red) indicate features that co-vary together, while strong negative
correlations (blue) indicate features with opposing patterns.

Clustering helps identify groups of features with similar correlation patterns.
}
\examples{
\dontrun{
# Fit RBM
rbm <- FitRBM(pbmc, hiddenFactors = "CellType", family = "zinb")

# Plot all partial correlations
heatmap_plot <- PlotRBMHeatmap(rbm)
print(heatmap_plot)

# Plot specific features
heatmap_plot <- PlotRBMHeatmap(
  rbm,
  features = c("CD3D", "CD8A", "CD4", "CD19"),
  title = "T and B Cell Marker Correlations"
)

# Use different color palette
heatmap_plot <- PlotRBMHeatmap(rbm, color_palette = "viridis")
}
}
