% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/partial_correlations.R
\name{EstimatePartialCorrelationsFromSeurat}
\alias{EstimatePartialCorrelationsFromSeurat}
\title{Estimate Partial Correlations from a Seurat Object}
\usage{
EstimatePartialCorrelationsFromSeurat(
  seuratObject,
  assay = "RNA",
  layer = "counts",
  visibleFeatures = NULL,
  family = "zinb",
  minNonZero = 10,
  progressr = TRUE,
  parallel = FALSE,
  numWorkers = NULL,
  verbose = TRUE
)
}
\arguments{
\item{seuratObject}{A Seurat object or SeuratObject containing single-cell data.}

\item{assay}{Character string specifying which assay to use (default: "RNA").}

\item{layer}{Character string specifying which layer to use (default: "counts").}

\item{visibleFeatures}{Character vector of feature (gene) names to include.
If NULL, uses all features (default: NULL).}

\item{family}{Character string specifying the distribution family for pseudolikelihood estimation.
Options: "zinb" (zero-inflated negative binomial, default), "nb" (negative binomial),
"poisson", "gaussian", "quasipoisson".}

\item{minNonZero}{Minimum number of non-zero observations required for a feature
pair to be estimated (default: 10).}

\item{progressr}{Logical indicating whether to use progressr for progress reporting
during parallel computation (default: TRUE).}

\item{parallel}{Logical indicating whether to use parallel processing (default: FALSE).}

\item{numWorkers}{Integer specifying number of workers for parallel processing.
If NULL, uses detectCores()-1 (default: NULL).}

\item{verbose}{Logical indicating whether to print progress messages (default: TRUE).}
}
\value{
An object of class "PartialCorrelations" containing:
  \itemize{
    \item partial_cor: Symmetric matrix of partial correlations between features
    \item se: Standard errors for each partial correlation (if computed)
    \item pvalues: P-values for testing H0: partial correlation = 0 (if computed)
    \item n_pairs: Number of valid feature pairs analyzed
    \item family: The family used for estimation
    \item features: Names of features included in the analysis
    \item excluded_features: Names of features excluded due to low counts
  }
}
\description{
Convenience wrapper around EstimatePartialCorrelations that accepts a Seurat
object directly. This is the recommended way to compute partial correlations
for use with FitRBM, as the output can be reused across multiple RBM fits.
}
\details{
This function extracts the expression matrix from the Seurat object and passes
it to EstimatePartialCorrelations. The returned PartialCorrelations object can
be passed directly to FitRBM via the partialCorrelations parameter, allowing
you to:
\itemize{
  \item Inspect partial correlations before fitting the RBM
  \item Reuse the same partial correlations across multiple RBM fits with different hidden factors
  \item Save and reload partial correlations to avoid recomputation
}
}
\examples{
\dontrun{
# Recommended workflow: Pre-compute partial correlations
pcor <- EstimatePartialCorrelationsFromSeurat(
  seuratObject = pbmc,
  family = "zinb",
  parallel = TRUE,
  verbose = TRUE
)

# Inspect the partial correlations
print(pcor)
heatmap(pcor$partial_cor[1:50, 1:50])

# Fit RBM with pre-computed correlations
rbm <- FitRBM(
  seuratObject = pbmc,
  hiddenFactors = "CellType",
  partialCorrelations = pcor
)

# Reuse for another RBM with different hidden factors
rbm2 <- FitRBM(
  seuratObject = pbmc,
  hiddenFactors = c("CellType", "Treatment"),
  partialCorrelations = pcor
)
}
}
