% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils.R
\name{residualize_gam}
\alias{residualize_gam}
\title{Residualize a numeric vector using a GAM fit from mgcv}
\usage{
residualize_gam(
  y,
  x,
  k = 10,
  bs = "tp",
  method = "REML",
  family = stats::gaussian(),
  use_bam = FALSE,
  ...
)
}
\arguments{
\item{y}{Numeric vector to be residualized (e.g. sizeFactor).}

\item{x}{Numeric predictor (e.g. saturation).}

\item{k}{Integer, basis dimension for the smooth (passed to mgcv::s). Default 10.}

\item{bs}{Character, smooth basis type (passed to mgcv::s). Default "tp".}

\item{method}{Character, smoothing selection method passed to mgcv::gam/bam. Default "REML".}

\item{family}{A family object for the GAM. Default gaussian().}

\item{use_bam}{Logical, use mgcv::bam instead of mgcv::gam for large data. Default FALSE.}

\item{...}{Additional arguments passed to mgcv::gam or mgcv::bam.}
}
\value{
A list with elements:
\describe{
  \item{residuals}{Numeric vector of residuals (same length as y).}
  \item{fitted}{Fitted values from the GAM (NA where fit not possible).}
  \item{model}{The fitted mgcv model object (or NULL if not fit).}
}
}
\description{
Fit a univariate GAM of y on x (a smooth of x) using mgcv and return residuals.
}
\examples{
\dontrun{
df <- data.frame(sizeFactor = rnorm(200, 10, 2), saturation = runif(200))
out <- residualize_gam(df$sizeFactor, df$saturation, k = 15)
df$sizeFactor_resid <- out$residuals
}

}
