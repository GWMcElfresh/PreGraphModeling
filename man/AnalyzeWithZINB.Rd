% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/pipelines.R
\name{AnalyzeWithZINB}
\alias{AnalyzeWithZINB}
\title{Subset and Fit ZINB Models Pipeline}
\usage{
AnalyzeWithZINB(
  seuratObject,
  groupByColumns,
  assay = "RNA",
  layer = "counts",
  saturationColumn = "Saturation.RNA",
  geneSubset = NULL,
  minNonZero = 3,
  parallel = FALSE,
  numWorkers = NULL,
  parallelPlan = NULL,
  verbose = TRUE
)
}
\arguments{
\item{seuratObject}{A Seurat object or SeuratObject containing single-cell data}

\item{groupByColumns}{Character vector of metadata column names to group by.
Multiple columns can be specified to create fine-grained subsets.}

\item{assay}{Character string specifying which assay to use (default: "RNA")}

\item{layer}{Character string specifying which layer to use (default: "counts")}

\item{saturationColumn}{Character string specifying the metadata column containing
cellular saturation values. If provided, size factors will be residualized against
saturation using GAM (default: "Saturation.RNA")}

\item{geneSubset}{Optional character vector of gene names to fit models for.
If NULL, models are fit for all genes (default: NULL).}

\item{minNonZero}{Minimum number of non-zero observations required to fit a model
(default: 3).}

\item{parallel}{Logical indicating whether to use parallel processing (default: FALSE).}

\item{numWorkers}{Integer specifying number of workers for parallel processing.
If NULL, uses detectCores()-1 (default: NULL).}

\item{parallelPlan}{Character string specifying the future plan to use for parallel processing.
Options: "multisession" (default, memory-safe), "multicore" (Unix only, faster but not memory-safe),
"cluster". If NULL, defaults to "multisession" (default: NULL).}

\item{verbose}{Logical indicating whether to print progress messages (default: TRUE).}
}
\value{
A list with four elements:
  \itemize{
    \item subset_matrices: List of expression matrices, one per subset
    \item group_metadata: Metadata for each subset
    \item model_parameters: List of data frames with estimated ZINB parameters for each subset
    \item combined_parameters: Single data frame with all parameters merged, including key and key_colnames
    \item timing: Data frame with elapsed time for each step
  }
}
\description{
This convenience function combines subsetting and zero-inflated negative
binomial model fitting into a single step. It subsets a Seurat object
according to specified metadata columns and then fits ZINB models to each
subset to estimate distribution parameters. Supports parallel processing.
}
\examples{
\dontrun{
# Complete analysis with single metadata column (uses Saturation.RNA by default)
result <- AnalyzeWithZINB(seurat_obj, groupByColumns = "CellType")

# Complete analysis with multiple metadata columns and parallel processing
result <- AnalyzeWithZINB(seurat_obj,
                         groupByColumns = c("CellType", "Sample"),
                         parallel = TRUE,
                         parallelPlan = "multisession")

# Use a different saturation column for residualization
result <- AnalyzeWithZINB(seurat_obj,
                         groupByColumns = "CellType",
                         saturationColumn = "percent.mt")

# Disable saturation correction
result <- AnalyzeWithZINB(seurat_obj,
                         groupByColumns = "CellType",
                         saturationColumn = NULL)

# Access results for first subset
head(result$model_parameters[[1]])

# Access combined parameters with keys
head(result$combined_parameters)
}
}
