% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/combined_analysis.R
\name{AnalyzeWithZINB}
\alias{AnalyzeWithZINB}
\title{Pseudobulk and Fit ZINB Models in One Step}
\usage{
AnalyzeWithZINB(
  seuratObject,
  groupByColumns,
  assay = "RNA",
  slot = "counts",
  geneSubset = NULL,
  minNonZero = 3,
  verbose = TRUE
)
}
\arguments{
\item{seuratObject}{A Seurat object or SeuratObject containing single-cell data}

\item{groupByColumns}{Character vector of metadata column names to group by.
Multiple columns can be specified to create fine-grained pseudobulk groups.}

\item{assay}{Character string specifying which assay to use (default: "RNA")}

\item{slot}{Character string specifying which slot to use (default: "counts")}

\item{geneSubset}{Optional character vector of gene names to fit models for.
If NULL, models are fit for all genes (default: NULL).}

\item{minNonZero}{Minimum number of non-zero observations required to fit a model
(default: 3).}

\item{verbose}{Logical indicating whether to print progress messages (default: TRUE).}
}
\value{
A list with three elements:
  \itemize{
    \item pseudobulk_matrix: The pseudobulked expression matrix
    \item group_metadata: Metadata for each pseudobulk sample
    \item model_parameters: Data frame with estimated ZINB parameters for each gene
  }
}
\description{
This convenience function combines pseudobulking and zero-inflated negative
binomial model fitting into a single step. It pseudobulks a Seurat object
according to specified metadata columns and then fits ZINB models to estimate
distribution parameters.
}
\examples{
\dontrun{
# Complete analysis with single metadata column
result <- AnalyzeWithZINB(seurat_obj, groupByColumns = "CellType")

# Complete analysis with multiple metadata columns
result <- AnalyzeWithZINB(seurat_obj, 
                         groupByColumns = c("CellType", "Sample"))

# Access results
head(result$model_parameters)
}
}
