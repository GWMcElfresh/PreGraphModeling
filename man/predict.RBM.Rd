% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/predict_rbm.R
\name{predict.RBM}
\alias{predict.RBM}
\title{Predict Hidden Layer Activations from Multi-Layer RBM}
\usage{
\method{predict}{RBM}(object, newdata = NULL, type = "activation", return_list = FALSE, ...)
}
\arguments{
\item{object}{An RBM object fitted using FitRBM().}

\item{newdata}{A matrix or data frame of expression values for visible features.
Rows should be features (matching those in the RBM) and columns are new observations.
If NULL, uses the training data (default: NULL).}

\item{type}{Character string specifying the type of prediction.
Only "activation" is supported. Note that this returns the *post-activation* output:
probabilities for binary (sigmoid) and categorical (softmax) layers, and linear scores
for continuous/ordinal layers (default: "activation").}

\item{return_list}{Logical indicating whether to return a list of activations per layer
(TRUE) or a combined matrix (FALSE, default).}

\item{...}{Additional arguments (unused).}
}
\value{
If return_list=FALSE (default): A combined matrix with all hidden unit activations.
  If return_list=TRUE: A list with one element per hidden layer containing activations.
}
\description{
Given a fitted multi-layer RBM and new expression data, predict the hidden layer 
activations for each metadata factor based on the learned weights and biases.
}
\details{
For each hidden layer, predictions are computed using the forward pass:
\deqn{h_layer = activation_function(W_layer^T \%*\% v + b_layer)}
where v is the visible layer (expression), W_layer is the weight matrix for that layer,
b_layer is the hidden bias for that layer, and activation_function depends on the
metadata type (sigmoid for binary, softmax for categorical, linear for continuous/ordinal).

For binary layers, the returned value can be interpreted as \eqn{P(h=1 | v)}.
For categorical layers, each row is a probability vector over levels (rows sum to 1).
For continuous/ordinal layers, the output is a score on the model's internal scale and
is not a calibrated likelihood.
}
\examples{
\dontrun{
# Fit RBM
rbm <- FitRBM(pbmc, hiddenFactors = c("CellType", "Treatment"), family = "zinb")

# Predict on new data - combined matrix
predictions <- predict(rbm, newdata = new_expr_matrix)

# Predict per layer
predictions_list <- predict(rbm, newdata = new_expr_matrix, return_list = TRUE)
}
}
