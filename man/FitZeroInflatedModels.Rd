% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/zinb_model.R
\name{FitZeroInflatedModels}
\alias{FitZeroInflatedModels}
\title{Fit Zero-Inflated Negative Binomial Models to Gene Expression}
\usage{
FitZeroInflatedModels(
  expressionMatrix,
  geneSubset = NULL,
  minNonZero = 3,
  verbose = TRUE
)
}
\arguments{
\item{expressionMatrix}{A numeric matrix where rows are genes and columns are samples.
Can be the pseudobulk_matrix output from PseudobulkSeurat.}

\item{geneSubset}{Optional character vector of gene names to fit models for.
If NULL, models are fit for all genes (default: NULL).}

\item{minNonZero}{Minimum number of non-zero observations required to fit a model.
Genes with fewer non-zero values are skipped (default: 3).}

\item{verbose}{Logical indicating whether to print progress messages (default: TRUE).}
}
\value{
A data frame with one row per gene containing:
  \itemize{
    \item gene: Gene name
    \item mu: Estimated mean parameter from the count model
    \item phi: Estimated dispersion parameter (theta in negative binomial)
    \item pi: Estimated zero-inflation probability
    \item converged: Logical indicating if the model converged
    \item n_nonzero: Number of non-zero observations for the gene
  }
}
\description{
This function fits zero-inflated negative binomial (ZINB) models to gene
expression data and extracts the estimated parameters: mu (mean), 
phi (dispersion), and pi (probability of zero).
}
\examples{
\dontrun{
# After pseudobulking
result <- PseudobulkSeurat(seurat_obj, groupByColumns = "CellType")

# Fit ZINB models to all genes
params <- FitZeroInflatedModels(result$pseudobulk_matrix)

# Fit models to subset of genes
params <- FitZeroInflatedModels(result$pseudobulk_matrix, 
                                 geneSubset = c("CD3D", "CD4", "CD8A"))
}
}
